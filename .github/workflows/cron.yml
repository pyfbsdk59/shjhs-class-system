name: æ¯æ—¥æ—©æ™¨é²åˆ°é€šçŸ¥è…³æœ¬

on:
  schedule:
    # GitHub ä½¿ç”¨ UTC æ™‚é–“ã€‚å°ç£æ™‚é–“ 08:15 æ¸›å» 8 å°æ™‚ = UTC çš„ 00:15
    # æ˜ŸæœŸ 1-5 ä»£è¡¨é€±ä¸€åˆ°é€±äº”åŸ·è¡Œ
    - cron: '15 0 * * 1-5'
  
  # å…è¨±æ‚¨åœ¨ GitHub ç¶²é ä¸Šæ‰‹å‹•é»æ“Šã€ŒRun workflowã€é€²è¡Œæ¸¬è©¦ï¼
  workflow_dispatch: 

jobs:
  send_absence_emails:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ å–å¾—ç¨‹å¼ç¢¼
        uses: actions/checkout@v4

      - name: ğŸ è¨­å®š Python ç’°å¢ƒ
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: ğŸ“¦ å®‰è£å¥—ä»¶
        run: |
          python -m pip install --upgrade pip
          pip install supabase

      - name: ğŸš€ åŸ·è¡Œå¯„ä¿¡è…³æœ¬
        env:
          SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
          SUPABASE_KEY: ${{ secrets.SUPABASE_KEY }}
          SENDER_EMAIL: ${{ secrets.SENDER_EMAIL }}
          SENDER_PASSWORD: ${{ secrets.SENDER_PASSWORD }}
        run: |
          python scripts/daily_absence.py